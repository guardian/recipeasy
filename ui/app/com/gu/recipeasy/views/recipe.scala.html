@import com.gu.recipeasy.models._
@(curatedRecipeForm: Form[models.CuratedRecipeForm],
        recipeId: String,
        body: String,
        articleId: String,
        shouldShowButtons: Boolean,
        images: List[ImageDB],
        pageTopMessage: String,
        showSkipThisRecipeButton: Boolean)(implicit messages: play.api.i18n.Messages, request: RequestHeader)
@import helper.CSRF
@implicitFC = @{ b4.vertical.fieldConstructor }
@link = @{ "https://www.theguardian.com/" + articleId }

@layout("Recipeasy"){
<div class="page-top-banner navbar navbar-fixed-top">
    @if(showSkipThisRecipeButton){
        <div style="float:right;">
            <a href="@routes.Application.curateOneRecipeInNewStatus" class="btn btn-danger recipe__original__skip-button">Skip this recipe</a>
        </div>
    }
    <div style="padding-top:8px;">
        @pageTopMessage
    </div>
</div>
<div class="recipe container-fluid">
    <div class="row">
        <div class="recipe__original col-md-5">

            <h2>Please fill in the form with this recipe</h2>
            <p>If some details are missing, <a href=@link target="_blank">click here for link to original article</a></p>
            <hr>
            <h4>@curatedRecipeForm("title").value</h4>
            @Html(body)
            <hr>
            <h2>Images</h2>
            @for(image <- images){
                <figure data-media-id="@image.mediaId" class="suggested-image">
                    <span class="suggested-image__add">Add to recipe</span>
                    <img src="@image.assetUrl">
                    <figcaption>@image.altText</figcaption>
                </figure>
            }
        </div>
        <div class="recipe__form col-md-7 offset-md-5">
        @b4.form(routes.Application.postCuratedRecipe(recipeId)) {
                    @CSRF.formField
                    <h2>Basic information</h2>
                    @b4.text( curatedRecipeForm("title"), '_label -> "Recipe title", 'class -> "form-control-sm")
                    @b4.text( curatedRecipeForm("credit"), '_label -> "Chef/Cook", 'class -> "form-control-sm typeahead")
                    <div class="flex field__times">
                        <div>
                            <label class="">Preparation time</label>
                            <div class="flex">
                                @b4.number( curatedRecipeForm("times")("preparationHours"), '_label -> "hours", 'placeholder -> "00", 'min -> 0, 'class -> "form-control-sm width-80")
                                @b4.number( curatedRecipeForm("times")("preparationMinutes"), '_label -> "minutes", 'placeholder -> "00", 'min -> 0, 'class -> "form-control-sm width-80")
                            </div>
                        </div>
                        <div>
                            <label class="">Cooking time</label>
                            <div class="flex">
                                @b4.number( curatedRecipeForm("times")("cookingHours"), '_label -> "hours", 'placeholder -> "00", 'min -> 0, 'class -> "form-control-sm width-80")
                                @b4.number( curatedRecipeForm("times")("cookingMinutes"), '_label -> "minutes", 'placeholder -> "00", 'min -> 0, 'class -> "form-control-sm width-80")
                            </div>
                        </div>
                    </div>
                    <h2>Servings</h2>
                    <label><input type="checkbox" id="field__serves-checkbox"> No serving information</label><br>
                    <div class="field__serves flex">
                        @b4.radio( curatedRecipeForm("serves")("portionType"),  options = Seq("ServesType" -> "Serves", "MakesType" -> "Makes"), '_inline -> true, 'label -> "Portion")
                        <div class="flex field__serves__quantity">
                            @b4.number( curatedRecipeForm("serves")("quantity")("from"), 'class -> "form-control-sm")
                            <label class="field__serves__quantity__label">to</label>
                            @b4.number( curatedRecipeForm("serves")("quantity")("to"), 'class -> "form-control-sm")
                        </div>
                    </div>
                    <hr>
                    <h2>Ingredients lists</h2>
                    @helpers.multiIngredientsList(curatedRecipeForm("ingredientsLists"), curatedRecipeForm)()
                    <div class="flex centre-children">
                        @b4.button('class -> "btn btn-info center-block ingredients-list__button-add") { <i class="fa fa-plus" aria-hidden="true"></i> Add another ingredient list }
                    </div>
                    <h2>Method</h2>
                    @helpers.multiStep( curatedRecipeForm("steps"), curatedRecipeForm)()
                    <hr>
                    <h2>Images</h2>
                    @helpers.multiImage(curatedRecipeForm("images"), curatedRecipeForm)()
                    <hr>
                    <h2>Additional information</h2>
                    <div class="flex wrap-children">
                        @helpers.multiTag(curatedRecipeForm("tags")("cuisine"), curatedRecipeForm)(Tag.cuisines, "cuisine", '_label -> "Cuisines")
                        @helpers.multiTag(curatedRecipeForm("tags")("category"), curatedRecipeForm)(Tag.category, "category", '_label -> "Category")
                        @helpers.multiTag(curatedRecipeForm("tags")("holiday"), curatedRecipeForm)(Tag.holidays, "holiday", '_label -> "Holidays")
                        @helpers.multiTag(curatedRecipeForm("tags")("dietary"), curatedRecipeForm)(Tag.dietary, "dietary", '_label -> "Dietary")
                    </div>
                    <hr>
                    <div class="flex centre-children">
                        @if(shouldShowButtons: Boolean) {
                            @b4.submit('class -> "btn btn-primary center-block") { Submit Recipe }
                        }
                    </div>
        }
        </div>
    </div>

    <div class="container">
        <nav class="navbar navbar-fixed-bottom navbar-light bg-danger">
        Select text and then press:
        <kbd>i</kbd> add a single <strong>i</strong>ngredient to list
        <kbd>l</kbd> add as <strong>l</strong>ist of ingredients
        <kbd>m</kbd> add as <strong>m</strong>ethod step
        </nav>
    </div>

    <script src="@routes.Assets.versioned("javascript/jquery.selection.js")" type="text/javascript"></script>
    <script src="@routes.Assets.versioned("javascript/mousetrap.min.js")" type="text/javascript"></script>
    <script src="@routes.Assets.versioned("javascript/typeahead.jquery.js")" type="text/javascript"></script>
    <script src="@routes.Assets.versioned("javascript/jquery.unevent.js")" type="text/javascript"></script>
    <script src="@routes.Assets.versioned("javascript/credits.json")" type="application/json"></script>
    <script src="@routes.Assets.versioned("javascript/editForm.js")" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.11.2/js/bootstrap-select.min.js"></script>

}

